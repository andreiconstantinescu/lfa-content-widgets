mixin gallery()
  .gallery
    - var arg = arguments
    - for (var i = 0; i < arg.length; i++) {
      - if (typeof(arg[i]) === 'string') {
          a(href=arg[i], data-lightbox="Album")
            - if (i === 0) {
                img(src=arg[0])
            - }
      - } else {
        - if (typeof(arg[i]) === 'object') {
          - var title = arg[i].title ? arg[i].title : ' ';
          a(href=arg[i].src, data-lightbox="Album", data-title=title)
            - if (i === 0) {
              - if (arg[0].tn) {
                  img(src=arg[0].tn)
              - } else {
                  img(src=arg[0].src)
              - }
            - }
        - } else {
            - throw new Error('invalid argumets for Lightbox widget.', arguments)
        - }
      - }
    - }

mixin kenburns() 
  .gallery-kenburns
    #kenburns-slideshow
    #kenburns-description
      #slide-title
    - var arg = arguments;
    - var imageLinks = [];
    - var titleLinks = [];
    
    - for (var i = 0; i < arg.length; i++) {
      - if (typeof arg[i] === 'string') {
        - imageLinks.push(arg[i]);
        - titleLinks.push(null);
      - }
      - else {
        - if (typeof arg[i] === 'object' && arg[i]) {
          - imageLinks.push(arg[i].src);
          - titleLinks[i] = arg[i].title;
        - } else {
          - throw new Error('invalid argumets for Ken Burns widget.', arguments)
        - }
      - }
    - }
    - imageLinks = JSON.stringify(imageLinks);
    - titleLinks = JSON.stringify(titleLinks)
    
    script.
      var imageLinks = JSON.parse('!{imageLinks}');
      var titles = JSON.parse('!{titleLinks}');
      console.log(titles);
      $('#kenburns-slideshow').Kenburns({
        images: imageLinks,
        scale: 0.75,
        duration:8000,
        fadeSpeed:1200,
        ease3d:'cubic-bezier(0.445, 0.050, 0.550, 0.950)',
        onSlideComplete: function(){
          $('#slide-title').html(titles[this.getSlideIndex()]);
        }
      });  
